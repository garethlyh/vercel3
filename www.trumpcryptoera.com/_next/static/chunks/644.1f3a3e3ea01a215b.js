(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[644],{2075:function(t){/*!
* Proton v4.2.1
* https://github.com/drawcall/Proton
*
* Copyright 2013-2020, A-JIE
* Licensed under the MIT license
* http://www.opensource.org/licenses/mit-license
*
*/t.exports=function(){"use strict";var t={PI:3.1415926,PIx2:6.2831852,PI_2:1.5707963,PI_180:3.1415926/180,N180_PI:57.295780490442965,Infinity:-999,isInfinity:function(t){return t===this.Infinity||t===1/0},randomAToB:function(t,e,i){return 2<arguments.length&&void 0!==i&&i?Math.floor(Math.random()*(e-t))+t:t+Math.random()*(e-t)},randomFloating:function(t,e,i){return this.randomAToB(t-e,t+e,i)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},randomZone:function(){},floor:function(t,e){return e=1<arguments.length&&void 0!==e?e:4,Math.floor(t*(e=Math.pow(10,e)))/e},degreeTransform:function(t){return 3.1415926*t/180},toColor16:function(t){return"#"+t.toString(16)}},e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")},a=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t};function n(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function r(t,e,i){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,e);return void 0!==a?"value"in a?a.value:void 0!==(a=a.get)?a.call(i):void 0:null!==(t=Object.getPrototypeOf(t))?r(t,e,i):void 0}var s=function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},o=function(t,e){if(!t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&("object"==typeof e||"function"==typeof e)?e:t},h=(a(l,[{key:"getValue",value:function(e){return e=0<arguments.length&&void 0!==e&&e,this.isArray?_.getRandFromArray(this.a):this.center?t.randomFloating(this.a,this.b,e):t.randomAToB(this.a,this.b,e)}}],[{key:"setSpanValue",value:function(t,e,i){return t instanceof l?t:void 0===e?new l(t):void 0===i?new l(t,e):new l(t,e,i)}},{key:"getSpanValue",value:function(t){return t instanceof l?t.getValue():t}}]),l);function l(t,e,a){i(this,l),_.isArray(t)?(this.isArray=!0,this.a=t):(this.isArray=!1,this.a=_.initValue(t,1),this.b=_.initValue(e,this.a),this.center=_.initValue(a,!1))}var u=function(t){--t;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1},c=function(t,e){return[1,0,0,0,1,0,t,e,1]},d=function(t){var e=Math.cos(t),t=Math.sin(t);return[e,-t,0,t,e,0,0,0,1]},p=function(t,e){var i=t[0],a=t[1],n=t[2],r=t[3],s=t[4],o=t[5],h=t[6],l=t[7],u=t[8],c=e[0],d=e[1],p=e[2],y=e[3],f=e[4],v=e[5],g=e[6],t=e[7],e=e[8];return[i*c+a*y+n*g,i*d+a*f+n*t,i*p+a*v+n*e,r*c+s*y+o*g,r*d+s*f+o*t,r*p+s*v+o*e,h*c+l*y+u*g,h*d+l*f+u*t,h*p+l*v+u*e]},y={createCanvas:function(t,e,i,a){var n=3<arguments.length&&void 0!==a?a:"absolute",a=document.createElement("canvas");return a.id=t,a.width=e,a.height=i,a.style.opacity=0,a.style.position=n,this.transform(a,-500,-500,0,0),a},createDiv:function(t,e,i){var a=document.createElement("div");return a.id=t,a.style.position="absolute",this.resize(a,e,i),a},resize:function(t,e,i){t.style.width=e+"px",t.style.height=i+"px",t.style.marginLeft=-e/2+"px",t.style.marginTop=-i/2+"px"},transform:function(t,e,i,a,n){t.style.willChange="transform",this.css3(t,"transform","translate("+e+"px, "+i+"px) scale("+a+") rotate("+n+"deg)")},transform3d:function(t,e,i,a,n){t.style.willChange="transform",n="translate3d("+e+"px, "+i+"px, 0) scale("+a+") rotate("+n+"deg)",this.css3(t,"backfaceVisibility","hidden"),this.css3(t,"transform",n)},css3:function(t,e,i){var a=e.charAt(0).toUpperCase()+e.substr(1);t.style["Webkit"+a]=i,t.style["Moz"+a]=i,t.style["O"+a]=i,t.style["ms"+a]=i,t.style[""+e]=i}},f={},v={},g=0,m=function(t,e,i){var a="string"==typeof t?t:t.src;f[a]?e(f[a],i):((t=new Image).onload=function(t){f[a]=t.target,e(f[a],i)},t.src=a)},b=function(t,e,i){var a,n,r=t.src;return v[r]||(a=u(t.width),n=u(t.height),(n=y.createCanvas("proton_canvas_cache_"+ ++g,a,n)).getContext("2d").drawImage(t,0,0,t.width,t.height),v[r]=n),e&&e(v[r],i),v[r]},_={initValue:function(t,e){return t=null!=t?t:e},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyArray:function(t){t&&(t.length=0)},toArray:function(t){return this.isArray(t)?t:[t]},getRandFromArray:function(t){return t?t[Math.floor(t.length*Math.random())]:null},emptyObject:function(t,e){var i,a=1<arguments.length&&void 0!==e?e:null;for(i in t)a&&-1<a.indexOf(i)||delete t[i]},classApply:function(t,e){return e=1<arguments.length&&void 0!==e?e:null,new(e?t.bind.apply(t,[null].concat(e)):t)},setVectorVal:function(t,e){e=1<arguments.length&&void 0!==e?e:null,e&&(this.hasProp(e,"x")&&(t.p.x=e.x),this.hasProp(e,"y")&&(t.p.y=e.y),this.hasProp(e,"vx")&&(t.v.x=e.vx),this.hasProp(e,"vy")&&(t.v.y=e.vy),this.hasProp(e,"ax")&&(t.a.x=e.ax),this.hasProp(e,"ay")&&(t.a.y=e.ay),this.hasProp(e,"p")&&t.p.copy(e.p),this.hasProp(e,"v")&&t.v.copy(e.v),this.hasProp(e,"a")&&t.a.copy(e.a),this.hasProp(e,"position")&&t.p.copy(e.position),this.hasProp(e,"velocity")&&t.v.copy(e.velocity),this.hasProp(e,"accelerate")&&t.a.copy(e.accelerate))},hasProp:function(t,e){return!!t&&void 0!==t[e]},setProp:function(t,e){for(var i in e)t.hasOwnProperty(i)&&(t[i]=h.getSpanValue(e[i]));return t},getImageData:function(t,e,i){var a;return a=e,t.drawImage(a,i.x,i.y),a=t.getImageData(i.x,i.y,i.width,i.height),t.clearRect(i.x,i.y,i.width,i.height),a},destroyAll:function(t,e){for(var i=1<arguments.length&&void 0!==e?e:null,a=t.length;a--;){try{t[a].destroy(i)}catch(t){}delete t[a]}t.length=0},assign:function(t,e){if("function"==typeof Object.assign)return Object.assign(t,e);for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}},k={},x={_index:0,_cache:{},id:function(t){return void 0!==k[t]&&null!==k[t]||(k[t]=0),t+"_"+k[t]++},getId:function(t){var e=this.getIdFromCache(t);return e||(e="PUID_"+this._index++,this._cache[e]=t,e)},getIdFromCache:function(t){var e,i=void 0;for(i in this._cache)if((e=this._cache[i])===t||this.isBody(e,t)&&e.src===t.src)return i;return null},isBody:function(t,i){return"object"===(void 0===t?"undefined":e(t))&&"object"===(void 0===i?"undefined":e(i))&&t.isInner&&i.isInner},getTarget:function(t){return this._cache[t]}},E=(a(P,[{key:"get",value:function(t,e,i){var a=void 0;return i=i||t.__puid||x.getId(t),(a=this.cache[i]&&0<this.cache[i].length?this.cache[i].pop():this.createOrClone(t,e)).__puid=t.__puid||i,a}},{key:"expire",value:function(t){return this.getCache(t.__puid).push(t)}},{key:"createOrClone",value:function(t,e){return this.total++,this.create?this.create(t,e):"function"==typeof t?_.classApply(t,e):t.clone()}},{key:"getCount",value:function(){var t,e=0;for(t in this.cache)e+=this.cache[t].length;return e++}},{key:"destroy",value:function(){for(var t in this.cache)this.cache[t].length=0,delete this.cache[t]}},{key:"getCache",value:function(t){return t=0<arguments.length&&void 0!==t?t:"default",this.cache[t]||(this.cache[t]=[]),this.cache[t]}}]),P);function P(t){i(this,P),this.total=0,this.cache={}}var A=(a(T,[{key:"update",value:function(t,e){this.add(t,e);var i=this.getEmitter(),t=this.getRenderer(),e="";switch(this.type){case 2:e+="emitter:"+this.proton.emitters.length+"<br>",i&&(e+="em speed:"+i.emitSpeed+"<br>"),i&&(e+="pos:"+this.getEmitterPos(i));break;case 3:i&&(e+="initializes:"+i.initializes.length+"<br>"),i&&(e+='<span style="display:inline-block;">'+this.concatArr(i.initializes)+"</span><br>"),i&&(e+="behaviours:"+i.behaviours.length+"<br>"),i&&(e+='<span style="display:inline-block;">'+this.concatArr(i.behaviours)+"</span><br>");break;case 4:t&&(e+=t.name+"<br>"),t&&(e+="body:"+this.getCreatedNumber(t)+"<br>");break;default:e+="particles:"+this.proton.getCount()+"<br>pool:"+this.proton.pool.getCount()+"<br>total:"+this.proton.pool.total}this.container.innerHTML=e}},{key:"add",value:function(t,e){var i=this;if(!this.container){this.type=1,this.container=document.createElement("div"),this.container.style.cssText="position:absolute;bottom:0px;left:0;cursor:pointer;opacity:0.9;z-index:10000;padding:10px;font-size:12px;font-family:Helvetica,Arial,sans-serif;width:120px;height:50px;background-color:#002;color:#0ff;",this.container.addEventListener("click",function(t){i.type++,4<i.type&&(i.type=1)},!1);var a=void 0,n=void 0;switch(t){case 2:a="#201",n="#f08";break;case 3:a="#020",n="#0f0";break;default:a="#002",n="#0ff"}this.container.style["background-color"]=a,this.container.style.color=n}this.container.parentNode||(e=e||this.body||document.body).appendChild(this.container)}},{key:"getEmitter",value:function(){return this.proton.emitters[this.emitterIndex]}},{key:"getRenderer",value:function(){return this.proton.renderers[this.rendererIndex]}},{key:"concatArr",value:function(t){var e="";if(!t||!t.length)return e;for(var i=0;i<t.length;i++)e+=(t[i].name||"").substr(0,1)+".";return e}},{key:"getCreatedNumber",value:function(t){return t.pool.total||t.cpool&&t.cpool.total||0}},{key:"getEmitterPos",value:function(t){return Math.round(t.p.x)+","+Math.round(t.p.y)}}]),T);function T(t){i(this,T),this.proton=t,this.container=null,this.type=1,this.emitterIndex=0,this.rendererIndex=0}var w=(a(R,[{key:"addEventListener",value:function(t,e){return this._listeners?this.removeEventListener(t,e):this._listeners={},this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),e}},{key:"removeEventListener",value:function(t,e){if(this._listeners&&this._listeners[t]){for(var i=this._listeners[t],a=i.length,n=0;n<a;n++)if(i[n]===e){1===a?delete this._listeners[t]:i.splice(n,1);break}}}},{key:"removeAllEventListeners",value:function(t){t?this._listeners&&delete this._listeners[t]:this._listeners=null}},{key:"dispatchEvent",value:function(t,e){var i=!1,a=this._listeners;if(t&&a){var n=a[t];if(!n)return i;for(var r=void 0,s=n.length;s--;)r=n[s],i=i||r(e)}return!!i}},{key:"hasEventListener",value:function(t){var e=this._listeners;return!(!e||!e[t])}}],[{key:"bind",value:function(t){t.prototype.dispatchEvent=R.prototype.dispatchEvent,t.prototype.hasEventListener=R.prototype.hasEventListener,t.prototype.addEventListener=R.prototype.addEventListener,t.prototype.removeEventListener=R.prototype.removeEventListener,t.prototype.removeAllEventListeners=R.prototype.removeAllEventListeners}}]),R);function R(){i(this,R),this._listeners=null}var O=(a(C,[{key:"calculate",value:function(t,e,i){this.eulerIntegrate(t,e,i)}},{key:"eulerIntegrate",value:function(t,e,i){t.sleep||(t.old.p.copy(t.p),t.old.v.copy(t.v),t.a.multiplyScalar(1/t.mass),t.v.add(t.a.multiplyScalar(e)),t.p.add(t.old.v.multiplyScalar(e)),i&&t.v.multiplyScalar(i),t.a.clear())}}]),C);function C(t){i(this,C),this.type=t}var I=(a(S,[{key:"addRenderer",value:function(t){t.init(this),this.renderers.push(t)}},{key:"removeRenderer",value:function(t){var e=this.renderers.indexOf(t);this.renderers.splice(e,1),t.remove(this)}},{key:"addEmitter",value:function(t){this.emitters.push(t),(t.parent=this).dispatchEvent(S.EMITTER_ADDED,t)}},{key:"removeEmitter",value:function(t){var e=this.emitters.indexOf(t);this.emitters.splice(e,1),t.parent=null,this.dispatchEvent(S.EMITTER_REMOVED,t)}},{key:"update",value:function(){"auto"===this._fps?(this.dispatchEvent(S.PROTON_UPDATE),S.USE_CLOCK?(this.then||(this.then=(new Date).getTime()),this.now=(new Date).getTime(),this.elapsed=.001*(this.now-this.then),this.amendChangeTabsBug(),0<this.elapsed&&this.emittersUpdate(this.elapsed),this.then=this.now):this.emittersUpdate(S.DEFAULT_INTERVAL),this.dispatchEvent(S.PROTON_UPDATE_AFTER)):(this.then||(this.then=(new Date).getTime()),this.now=(new Date).getTime(),this.elapsed=.001*(this.now-this.then),this.elapsed>this._interval&&(this.dispatchEvent(S.PROTON_UPDATE),this.emittersUpdate(this._interval),this.then=this.now-this.elapsed%this._interval*1e3,this.dispatchEvent(S.PROTON_UPDATE_AFTER)))}},{key:"emittersUpdate",value:function(t){for(var e=this.emitters.length;e--;)this.emitters[e].update(t)}},{key:"amendChangeTabsBug",value:function(){S.amendChangeTabsBug&&.5<this.elapsed&&(this.then=(new Date).getTime(),this.elapsed=0)}},{key:"getCount",value:function(){for(var t=0,e=this.emitters.length;e--;)t+=this.emitters[e].particles.length;return t}},{key:"getAllParticles",value:function(){for(var t=[],e=this.emitters.length;e--;)t=t.concat(this.emitters[e].particles);return t}},{key:"destroyAllEmitters",value:function(){_.destroyAll(this.emitters)}},{key:"destroy",value:function(t){function e(){i.time=0,i.then=0,i.pool.destroy(),_.destroyAll(i.emitters),_.destroyAll(i.renderers,i.getAllParticles())}var i=this;0<arguments.length&&void 0!==t&&t?setTimeout(e,200):e()}},{key:"fps",set:function(e){this._fps=e,this._interval="auto"===e?S.DEFAULT_INTERVAL:t.floor(1/e,7)},get:function(){return this._fps}}]),S);function S(t){i(this,S),this.emitters=[],this.renderers=[],this.time=0,this.now=0,this.then=0,this.elapsed=0,this.stats=new A(this),this.pool=new E(80),this.integrationType=_.initValue(t,S.EULER),this.integrator=new O(this.integrationType),this._fps="auto",this._interval=S.DEFAULT_INTERVAL}I.USE_CLOCK=!1,I.MEASURE=100,I.EULER="euler",I.RK2="runge-kutta2",I.PARTICLE_CREATED="PARTICLE_CREATED",I.PARTICLE_UPDATE="PARTICLE_UPDATE",I.PARTICLE_SLEEP="PARTICLE_SLEEP",I.PARTICLE_DEAD="PARTICLE_DEAD",I.EMITTER_ADDED="EMITTER_ADDED",I.EMITTER_REMOVED="EMITTER_REMOVED",I.PROTON_UPDATE="PROTON_UPDATE",I.PROTON_UPDATE_AFTER="PROTON_UPDATE_AFTER",I.DEFAULT_INTERVAL=.0167,I.amendChangeTabsBug=!0,w.bind(I);var D=(a(M,[{key:"reset",value:function(){this.r=255,this.g=255,this.b=255}}]),M);function M(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:255,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:255,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:255;i(this,M),this.r=t,this.g=e,this.b=a}var V={easeLinear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInSine:function(e){return 1-Math.cos(e*t.PI_2)},easeOutSine:function(e){return Math.sin(e*t.PI_2)},easeInOutSine:function(t){return -.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInBack:function(t){return t*t*(2.70158*t-1.70158)},easeOutBack:function(t){return--t*t*(2.70158*t+1.70158)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},getEasing:function(t){return"function"==typeof t?t:this[t]||this.easeLinear}},B=(a(L,[{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"getGradient",value:function(){return 0!==this.x?Math.atan2(this.y,this.x):0<this.y?t.PI_2:this.y<0?-t.PI_2:void 0}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"add",value:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)}},{key:"addXY",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"addVectors",value:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}},{key:"sub",value:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}},{key:"divideScalar",value:function(t){return 0!==t?(this.x/=t,this.y/=t):this.set(0,0),this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this}},{key:"negate",value:function(){return this.multiplyScalar(-1)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length())}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"rotate",value:function(t){var e=this.x,i=this.y;return this.x=e*Math.cos(t)+i*Math.sin(t),this.y=-e*Math.sin(t)+i*Math.cos(t),this}},{key:"distanceToSquared",value:function(t){var e=this.x-t.x,t=this.y-t.y;return e*e+t*t}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y}},{key:"clear",value:function(){return this.x=0,this.y=0,this}},{key:"clone",value:function(){return new L(this.x,this.y)}}]),L);function L(t,e){i(this,L),this.x=t||0,this.y=e||0}var U=(a(F,[{key:"getDirection",value:function(){return Math.atan2(this.v.x,-this.v.y)*t.N180_PI}},{key:"reset",value:function(){return this.life=1/0,this.age=0,this.dead=!1,this.sleep=!1,this.body=null,this.sprite=null,this.parent=null,this.energy=1,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.rotation=0,this.color=null,this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.easing=V.easeLinear,this.rgb.reset(),_.emptyObject(this.data),this.removeAllBehaviours(),this}},{key:"update",value:function(t,e){this.sleep||(this.age+=t,this.applyBehaviours(t,e)),this.age<this.life?(e=this.easing(this.age/this.life),this.energy=Math.max(1-e,0)):this.destroy()}},{key:"applyBehaviours",value:function(t,e){for(var i=this.behaviours.length,a=void 0,a=0;a<i;a++)this.behaviours[a]&&this.behaviours[a].applyBehaviour(this,t,e)}},{key:"addBehaviour",value:function(t){this.behaviours.push(t),t.hasOwnProperty("parents")&&t.parents.push(this),t.initialize(this)}},{key:"addBehaviours",value:function(t){for(var e=t.length,i=void 0,i=0;i<e;i++)this.addBehaviour(t[i])}},{key:"removeBehaviour",value:function(t){-1<(t=this.behaviours.indexOf(t))&&(this.behaviours.splice(t,1).parents=null)}},{key:"removeAllBehaviours",value:function(){_.emptyArray(this.behaviours)}},{key:"destroy",value:function(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null}}]),F);function F(t){i(this,F),this.id="",this.old={},this.data={},this.behaviours=[],this.p=[],this.v=[],this.a=[],this.rgb={},this.name="Particle",this.id=x.id(this.name),this.old={},this.data={},this.behaviours=[],this.p=new B,this.v=new B,this.a=new B,this.old.p=new B,this.old.v=new B,this.old.a=new B,this.rgb=new D,this.reset(),t&&_.setProp(this,t)}var z={hexToRgb:function(t){return{r:parseInt((t="#"===t.charAt(0)?t.substring(1,7):t).substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}},rgbToHex:function(t){return"rgb("+t.r+", "+t.g+", "+t.b+")"},getHex16FromParticle:function(t){return 65536*Number(t.rgb.r)+256*Number(t.rgb.g)+Number(t.rgb.b)}},j=(a(H,[{key:"set",value:function(t,e){return this.r=t,this.tha=e,this}},{key:"setR",value:function(t){return this.r=t,this}},{key:"setTha",value:function(t){return this.tha=t,this}},{key:"copy",value:function(t){return this.r=t.r,this.tha=t.tha,this}},{key:"toVector",value:function(){return new B(this.getX(),this.getY())}},{key:"getX",value:function(){return this.r*Math.sin(this.tha)}},{key:"getY",value:function(){return-this.r*Math.cos(this.tha)}},{key:"normalize",value:function(){return this.r=1,this}},{key:"equals",value:function(t){return t.r===this.r&&t.tha===this.tha}},{key:"clear",value:function(){return this.r=0,this.tha=0,this}},{key:"clone",value:function(){return new H(this.r,this.tha)}}]),H);function H(t,e){i(this,H),this.r=Math.abs(t)||0,this.tha=e||0}var N={create:function(t){var e=new Float32Array(9);return t&&this.set(t,e),e},set:function(t,e){for(var i=0;i<9;i++)e[i]=t[i];return e},multiply:function(t,e,i){var a=t[0],n=t[1],r=t[2],s=t[3],o=t[4],h=t[6],l=t[7],u=e[0],c=e[1],d=e[2],p=e[3],y=e[4],t=e[6],e=e[7];return i[0]=u*a+c*s,i[1]=u*n+c*o,i[2]=r*d,i[3]=p*a+y*s,i[4]=p*n+y*o,i[6]=t*a+e*s+h,i[7]=t*n+e*o+l,i},inverse:function(t,e){var i=t[0],a=t[1],n=t[3],r=t[4],s=t[6],o=t[7],h=-n,t=o*n-r*s,n=1/(i*r+a*h);return e[0]=r*n,e[1]=-a*n,e[3]=h*n,e[4]=i*n,e[6]=t*n,e[7]=(-o*i+a*s)*n,e},multiplyVec2:function(t,e,i){var a=e[0],e=e[1];return i[0]=a*t[0]+e*t[3]+t[6],i[1]=a*t[1]+e*t[4]+t[7],i}},q=(s(G,h),a(G,[{key:"getValue",value:function(){var e=_.getRandFromArray(this._arr);return"random"===e||"Random"===e?t.randomColor():e}}],[{key:"createArraySpan",value:function(t){return t?t instanceof G?t:new G(t):null}}]),G);function G(t){i(this,G);var e=o(this,(G.__proto__||Object.getPrototypeOf(G)).call(this));return e._arr=_.toArray(t),e}var X=(a(Y,[{key:"contains",value:function(t,e){return t<=this.right&&t>=this.x&&e<=this.bottom&&e>=this.y}}]),Y);function Y(t,e,a,n){i(this,Y),this.x=t,this.y=e,this.width=a,this.height=n,this.bottom=this.y+this.height,this.right=this.x+this.width}var W=(a(Z,[{key:"init",value:function(){this.startTime=0,this.nextTime=this.timePan.getValue()}},{key:"getValue",value:function(t){return this.startTime+=t,this.startTime>=this.nextTime?(this.startTime=0,this.nextTime=this.timePan.getValue(),1===this.numPan.b?.5<this.numPan.getValue(!1)?1:0:this.numPan.getValue(!0)):0}}]),Z);function Z(t,e){i(this,Z),this.numPan=h.setSpanValue(_.initValue(t,1)),this.timePan=h.setSpanValue(_.initValue(e,1)),this.startTime=0,this.nextTime=0,this.init()}var Q=(a(K,[{key:"reset",value:function(){}},{key:"init",value:function(t,e){e?this.initialize(e):this.initialize(t)}},{key:"initialize",value:function(){}}]),K);function K(){i(this,K)}var J=(s($,Q),a($,[{key:"initialize",value:function(t){this.lifePan.a===1/0?t.life=1/0:t.life=this.lifePan.getValue()}}]),$);function $(t,e,a){i(this,$);var n=o(this,($.__proto__||Object.getPrototypeOf($)).call(this));return n.lifePan=h.setSpanValue(t,e,a),n.name="Life",n}var tt=(a(te,[{key:"getPosition",value:function(){}},{key:"crossing",value:function(){}}]),te);function te(){i(this,te),this.vector=new B(0,0),this.random=0,this.crossType="dead",this.alert=!0}var ti=(s(ta,tt),a(ta,[{key:"getPosition",value:function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector}},{key:"crossing",value:function(){this.alert&&(console.error("Sorry, PointZone does not support crossing method!"),this.alert=!1)}}]),ta);function ta(t,e){i(this,ta);var a=o(this,(ta.__proto__||Object.getPrototypeOf(ta)).call(this));return a.x=t,a.y=e,a}var tn=(s(tr,Q),a(tr,[{key:"reset",value:function(t){this.zone=_.initValue(t,new ti)}},{key:"initialize",value:function(t){this.zone.getPosition(),t.p.x=this.zone.vector.x,t.p.y=this.zone.vector.y}}]),tr);function tr(t){i(this,tr);var e=o(this,(tr.__proto__||Object.getPrototypeOf(tr)).call(this));return e.zone=_.initValue(t,new ti),e.name="Position",e}var ts=(s(to,Q),a(to,[{key:"reset",value:function(t,e,i){this.rPan=h.setSpanValue(t),this.thaPan=h.setSpanValue(e),this.type=_.initValue(i,"vector")}},{key:"normalizeVelocity",value:function(t){return t*I.MEASURE}},{key:"initialize",value:function(e){var i;"p"===this.type||"P"===this.type||"polar"===this.type?(i=new j(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*t.PI_180),e.v.x=i.getX(),e.v.y=i.getY()):(e.v.x=this.normalizeVelocity(this.rPan.getValue()),e.v.y=this.normalizeVelocity(this.thaPan.getValue()))}}]),to);function to(t,e,a){i(this,to);var n=o(this,(to.__proto__||Object.getPrototypeOf(to)).call(this));return n.rPan=h.setSpanValue(t),n.thaPan=h.setSpanValue(e),n.type=_.initValue(a,"vector"),n.name="Velocity",n}var th=(s(tl,Q),a(tl,[{key:"initialize",value:function(t){t.mass=this.massPan.getValue()}}]),tl);function tl(t,e,a){i(this,tl);var n=o(this,(tl.__proto__||Object.getPrototypeOf(tl)).call(this));return n.massPan=h.setSpanValue(t,e,a),n.name="Mass",n}var tu=(s(tc,Q),a(tc,[{key:"reset",value:function(t,e,i){this.radius=h.setSpanValue(t,e,i)}},{key:"initialize",value:function(t){t.radius=this.radius.getValue(),t.data.oldRadius=t.radius}}]),tc);function tc(t,e,a){i(this,tc);var n=o(this,(tc.__proto__||Object.getPrototypeOf(tc)).call(this));return n.radius=h.setSpanValue(t,e,a),n.name="Radius",n}var td=(s(tp,Q),a(tp,[{key:"initialize",value:function(t){var e=this.image.getValue();t.body="string"==typeof e?{width:this.w,height:this.h,src:e,isInner:!0,inner:!0}:e}},{key:"setSpanValue",value:function(t){return t instanceof q?t:new q(t)}}]),tp);function tp(t,e,a){i(this,tp);var n=o(this,(tp.__proto__||Object.getPrototypeOf(tp)).call(this));return n.image=n.setSpanValue(t),n.w=_.initValue(e,20),n.h=_.initValue(a,n.w),n.name="Body",n}var ty=(a(tf,[{key:"reset",value:function(t,e){this.life=_.initValue(t,1/0),this.easing=V.getEasing(e)}},{key:"normalizeForce",value:function(t){return t.multiplyScalar(I.MEASURE)}},{key:"normalizeValue",value:function(t){return t*I.MEASURE}},{key:"initialize",value:function(){}},{key:"calculate",value:function(t,e){this.age+=e,this.age>=this.life||this.dead?(this.energy=0,this.dead=!0,this.destroy()):(t=this.easing(t.age/t.life),this.energy=Math.max(1-t,0))}},{key:"destroy",value:function(){for(var t=this.parents.length;t--;)this.parents[t].removeBehaviour(this);this.parents.length=0}}]),tf);function tf(t,e){i(this,tf),this.life=_.initValue(t,1/0),this.easing=V.getEasing(e),this.age=0,this.energy=1,this.dead=!1,this.parents=[],this.id="Behaviour_"+tf.id++,this.name="Behaviour"}ty.id=0;var tv=(s(tg,ty),a(tg,[{key:"reset",value:function(t,e,i,a){this.force=this.normalizeForce(new B(t,e)),i&&r(tg.prototype.__proto__||Object.getPrototypeOf(tg.prototype),"reset",this).call(this,i,a)}},{key:"applyBehaviour",value:function(t,e,i){this.calculate(t,e,i),t.a.add(this.force)}}]),tg);function tg(t,e,a,n){return i(this,tg),(n=o(this,(tg.__proto__||Object.getPrototypeOf(tg)).call(this,a,n))).force=n.normalizeForce(new B(t,e)),n.name="Force",n}var tm=(s(tb,ty),a(tb,[{key:"reset",value:function(t,e,i,a,n){this.targetPosition=_.initValue(t,new B),this.radius=_.initValue(i,1e3),this.force=_.initValue(this.normalizeValue(e),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new B,this.lengthSq=0,a&&r(tb.prototype.__proto__||Object.getPrototypeOf(tb.prototype),"reset",this).call(this,a,n)}},{key:"applyBehaviour",value:function(t,e,i){this.calculate(t,e,i),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(t.p),this.lengthSq=this.attractionForce.lengthSq(),4e-5<this.lengthSq&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.multiplyScalar(1-this.lengthSq/this.radiusSq),this.attractionForce.multiplyScalar(this.force),t.a.add(this.attractionForce))}}]),tb);function tb(t,e,a,n,r){return i(this,tb),(r=o(this,(tb.__proto__||Object.getPrototypeOf(tb)).call(this,n,r))).targetPosition=_.initValue(t,new B),r.radius=_.initValue(a,1e3),r.force=_.initValue(r.normalizeValue(e),100),r.radiusSq=r.radius*r.radius,r.attractionForce=new B,r.lengthSq=0,r.name="Attraction",r}var t_=(s(tk,ty),a(tk,[{key:"reset",value:function(t,e,i,a,n){this.panFoce=new B(t,e),this.panFoce=this.normalizeForce(this.panFoce),this.delay=i,a&&r(tk.prototype.__proto__||Object.getPrototypeOf(tk.prototype),"reset",this).call(this,a,n)}},{key:"initialize",value:function(t){t.data.time=0}},{key:"applyBehaviour",value:function(e,i,a){this.calculate(e,i,a),e.data.time+=i,e.data.time>=this.delay&&(e.a.addXY(t.randomAToB(-this.panFoce.x,this.panFoce.x),t.randomAToB(-this.panFoce.y,this.panFoce.y)),e.data.time=0)}}]),tk);function tk(t,e,a,n,r){return i(this,tk),(r=o(this,(tk.__proto__||Object.getPrototypeOf(tk)).call(this,n,r))).reset(t,e,a),r.time=0,r.name="RandomDrift",r}var tx=(s(tE,tv),a(tE,[{key:"reset",value:function(t,e,i){r(tE.prototype.__proto__||Object.getPrototypeOf(tE.prototype),"reset",this).call(this,0,t,e,i)}}]),tE);function tE(t,e,a){return i(this,tE),(a=o(this,(tE.__proto__||Object.getPrototypeOf(tE)).call(this,0,t,e,a))).name="Gravity",a}var tP=(s(tA,ty),a(tA,[{key:"reset",value:function(t,e,i,a,n){this.emitter=_.initValue(t,null),this.mass=_.initValue(e,!0),this.callback=_.initValue(i,null),this.collisionPool=[],this.delta=new B,a&&r(tA.prototype.__proto__||Object.getPrototypeOf(tA.prototype),"reset",this).call(this,a,n)}},{key:"applyBehaviour",value:function(t,e,i){for(var a,n,r,s,o,h,l=(this.emitter?this.emitter.particles:this.pool).slice(i),u=l.length,c=void 0,d=void 0,d=0;d<u;d++)(c=l[d])!==t&&(this.delta.copy(c.p),this.delta.sub(t.p),(a=this.delta.lengthSq())<=(h=t.radius+c.radius)*h&&(n=h-Math.sqrt(a)+.5,r=t.mass+c.mass,s=this.mass?c.mass/r:.5,o=this.mass?t.mass/r:.5,t.p.add(this.delta.clone().normalize().multiplyScalar(-(n*s))),c.p.add(this.delta.normalize().multiplyScalar(n*o)),this.callback&&this.callback(t,c)))}}]),tA);function tA(t,e,a,n,r){return i(this,tA),(r=o(this,(tA.__proto__||Object.getPrototypeOf(tA)).call(this,n,r))).reset(t,e,a),r.name="Collision",r}var tT=(s(tw,ty),a(tw,[{key:"reset",value:function(t,e,i,a){this.zone=t,this.zone.crossType=_.initValue(e,"dead"),i&&r(tw.prototype.__proto__||Object.getPrototypeOf(tw.prototype),"reset",this).call(this,i,a)}},{key:"applyBehaviour",value:function(t,e,i){this.calculate(t,e,i),this.zone.crossing(t)}}]),tw);function tw(t,e,a,n){return i(this,tw),(n=o(this,(tw.__proto__||Object.getPrototypeOf(tw)).call(this,a,n))).reset(t,e),n.name="CrossZone",n}var tR=(s(tO,ty),a(tO,[{key:"reset",value:function(t,e,i,a){this.same=null==e,this.a=h.setSpanValue(_.initValue(t,1)),this.b=h.setSpanValue(e),i&&r(tO.prototype.__proto__||Object.getPrototypeOf(tO.prototype),"reset",this).call(this,i,a)}},{key:"initialize",value:function(t){t.data.alphaA=this.a.getValue(),this.same?t.data.alphaB=t.data.alphaA:t.data.alphaB=this.b.getValue()}},{key:"applyBehaviour",value:function(t,e,i){this.calculate(t,e,i),t.alpha=t.data.alphaB+(t.data.alphaA-t.data.alphaB)*this.energy,t.alpha<.001&&(t.alpha=0)}}]),tO);function tO(t,e,a,n){return i(this,tO),(n=o(this,(tO.__proto__||Object.getPrototypeOf(tO)).call(this,a,n))).reset(t,e),n.name="Alpha",n}var tC=(s(tI,ty),a(tI,[{key:"reset",value:function(t,e,i,a){this.same=null==e,this.a=h.setSpanValue(_.initValue(t,1)),this.b=h.setSpanValue(e),i&&r(tI.prototype.__proto__||Object.getPrototypeOf(tI.prototype),"reset",this).call(this,i,a)}},{key:"initialize",value:function(t){t.data.scaleA=this.a.getValue(),t.data.oldRadius=t.radius,t.data.scaleB=this.same?t.data.scaleA:this.b.getValue()}},{key:"applyBehaviour",value:function(t,e,i){this.calculate(t,e,i),t.scale=t.data.scaleB+(t.data.scaleA-t.data.scaleB)*this.energy,t.scale<1e-4&&(t.scale=0),t.radius=t.data.oldRadius*t.scale}}]),tI);function tI(t,e,a,n){return i(this,tI),(n=o(this,(tI.__proto__||Object.getPrototypeOf(tI)).call(this,a,n))).reset(t,e),n.name="Scale",n}var tS=(s(tD,ty),a(tD,[{key:"reset",value:function(t,e,i,a,n){this.same=null==e,this.a=h.setSpanValue(_.initValue(t,"Velocity")),this.b=h.setSpanValue(_.initValue(e,0)),this.style=_.initValue(i,"to"),a&&r(tD.prototype.__proto__||Object.getPrototypeOf(tD.prototype),"reset",this).call(this,a,n)}},{key:"initialize",value:function(t){t.rotation=this.a.getValue(),t.data.rotationA=this.a.getValue(),this.same||(t.data.rotationB=this.b.getValue())}},{key:"applyBehaviour",value:function(t,e,i){this.calculate(t,e,i),this.same?"V"!==this.a.a&&"Velocity"!==this.a.a&&"v"!==this.a.a||(t.rotation=t.getDirection()):"to"===this.style||"TO"===this.style||"_"===this.style?t.rotation+=t.data.rotationB+(t.data.rotationA-t.data.rotationB)*this.energy:t.rotation+=t.data.rotationB}}]),tD);function tD(t,e,a,n,r){return i(this,tD),(r=o(this,(tD.__proto__||Object.getPrototypeOf(tD)).call(this,n,r))).reset(t,e,a),r.name="Rotate",r}var tM=(s(tV,ty),a(tV,[{key:"reset",value:function(t,e,i,a){this.a=q.createArraySpan(t),this.b=q.createArraySpan(e),i&&r(tV.prototype.__proto__||Object.getPrototypeOf(tV.prototype),"reset",this).call(this,i,a)}},{key:"initialize",value:function(t){t.color=this.a.getValue(),t.data.colorA=z.hexToRgb(t.color),this.b&&(t.data.colorB=z.hexToRgb(this.b.getValue()))}},{key:"applyBehaviour",value:function(t,e,i){this.b?(this.calculate(t,e,i),t.rgb.r=t.data.colorB.r+(t.data.colorA.r-t.data.colorB.r)*this.energy,t.rgb.g=t.data.colorB.g+(t.data.colorA.g-t.data.colorB.g)*this.energy,t.rgb.b=t.data.colorB.b+(t.data.colorA.b-t.data.colorB.b)*this.energy,t.rgb.r=Math.floor(t.rgb.r),t.rgb.g=Math.floor(t.rgb.g),t.rgb.b=Math.floor(t.rgb.b)):(t.rgb.r=t.data.colorA.r,t.rgb.g=t.data.colorA.g,t.rgb.b=t.data.colorA.b)}}]),tV);function tV(t,e,a,n){return i(this,tV),(n=o(this,(tV.__proto__||Object.getPrototypeOf(tV)).call(this,a,n))).reset(t,e),n.name="Color",n}var tB="changing",tL=(s(tU,ty),a(tU,[{key:"setAngleAndForce",value:function(e,i){this.force=tB,this.angle=t.PI/2,"right"===e?this.angle=t.PI/2:"left"===e?this.angle=-t.PI/2:"random"===e?this.angle="random":e instanceof h?(this.angle="span",this.span=e):e&&(this.angle=e),"changing"===String(i).toLowerCase()||"chang"===String(i).toLowerCase()||"auto"===String(i).toLowerCase()?this.force=tB:i&&(this.force=i)}},{key:"reset",value:function(e,i,a,n){this.angle=t.PI/2,this.setAngleAndForce(e,i),a&&r(tU.prototype.__proto__||Object.getPrototypeOf(tU.prototype),"reset",this).call(this,a,n)}},{key:"initialize",value:function(e){"random"===this.angle?e.data.cangle=t.randomAToB(-t.PI,t.PI):"span"===this.angle&&(e.data.cangle=this.span.getValue()),e.data.cyclone=new B(0,0)}},{key:"applyBehaviour",value:function(t,e,i){this.calculate(t,e,i),e=void 0,i=t.v.getGradient(),"random"===this.angle||"span"===this.angle?i+=t.data.cangle:i+=this.angle,e=this.force===tB?t.v.length()/100:this.force,t.data.cyclone.x=e*Math.cos(i),t.data.cyclone.y=e*Math.sin(i),t.data.cyclone=this.normalizeForce(t.data.cyclone),t.a.add(t.data.cyclone)}}]),tU);function tU(t,e,a,n){return i(this,tU),(n=o(this,(tU.__proto__||Object.getPrototypeOf(tU)).call(this,a,n))).setAngleAndForce(t,e),n.name="Cyclone",n}var tF=(s(tz,tm),a(tz,[{key:"reset",value:function(t,e,i,a,n){r(tz.prototype.__proto__||Object.getPrototypeOf(tz.prototype),"reset",this).call(this,t,e,i,a,n),this.force*=-1}}]),tz);function tz(t,e,a,n,r){return i(this,tz),r=o(this,(tz.__proto__||Object.getPrototypeOf(tz)).call(this,t,e,a,n,r)),r.force*=-1,r.name="Repulsion",r}var tj=(s(tH,ty),a(tH,[{key:"reset",value:function(t,e,i,a){this.distanceVec=new B,this.centerPoint=_.initValue(t,new B),this.force=_.initValue(this.normalizeValue(e),100),i&&r(tH.prototype.__proto__||Object.getPrototypeOf(tH.prototype),"reset",this).call(this,i,a)}},{key:"initialize",value:function(){}},{key:"applyBehaviour",value:function(t,e){this.distanceVec.set(this.centerPoint.x-t.p.x,this.centerPoint.y-t.p.y);var i,a=this.distanceVec.lengthSq();0!==a&&(i=this.distanceVec.length(),i=this.force*e/(a*i),t.v.x+=i*this.distanceVec.x,t.v.y+=i*this.distanceVec.y)}}]),tH);function tH(t,e,a,n){return i(this,tH),(n=o(this,(tH.__proto__||Object.getPrototypeOf(tH)).call(this,a,n))).distanceVec=new B,n.centerPoint=_.initValue(t,new B),n.force=_.initValue(n.normalizeValue(e),100),n.name="GravityWell",n}var tN={initialize:function(t,e,i){for(var a=i.length,n=void 0,n=0;n<a;n++)i[n]instanceof Q?i[n].init(t,e):this.init(t,e,i[n]);this.bindEmitter(t,e)},init:function(t,e,i){_.setProp(e,i),_.setVectorVal(e,i)},bindEmitter:function(e,i){e.bindEmitter&&(i.p.add(e.p),i.v.add(e.v),i.a.add(e.a),i.v.rotate(t.degreeTransform(e.rotation)))}},tq=(s(tG,U),a(tG,[{key:"emit",value:function(t,e){this.stoped=!1,this.emitTime=0,this.totalTime=_.initValue(t,1/0),!0===e||"life"===e||"destroy"===e?this.life="once"===t?1:this.totalTime:isNaN(e)||(this.life=e),this.rate.init()}},{key:"stop",value:function(){this.totalTime=-1,this.emitTime=0,this.stoped=!0}},{key:"preEmit",value:function(t){var e=this.stoped,i=this.emitTime,a=this.totalTime;for(this.stoped=!1,this.emitTime=0,this.totalTime=t,this.rate.init();.0167<t;)t-=.0167,this.update(.0167);this.stoped=e,this.emitTime=i+Math.max(t,0),this.totalTime=a}},{key:"removeAllParticles",value:function(){for(var t=this.particles.length;t--;)this.particles[t].dead=!0}},{key:"addSelfInitialize",value:function(t){t.init?t.init(this):this.initAll()}},{key:"addInitialize",value:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var a=e.length;a--;)this.initializes.push(e[a])}},{key:"removeInitialize",value:function(t){-1<(t=this.initializes.indexOf(t))&&this.initializes.splice(t,1)}},{key:"removeAllInitializers",value:function(){_.emptyArray(this.initializes)}},{key:"addBehaviour",value:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var a=arguments.length;a--;){var n=e[a];this.behaviours.push(n),n.parents&&n.parents.push(this)}}},{key:"removeBehaviour",value:function(t){var e=this.behaviours.indexOf(t);return this.behaviours.splice(e,1),t.parents&&(e=t.parents.indexOf(t),t.parents.splice(e,1)),e}},{key:"removeAllBehaviours",value:function(){_.emptyArray(this.behaviours)}},{key:"update",value:function(t){this.age+=t,(this.age>=this.life||this.dead)&&this.destroy(),this.emitting(t),this.integrate(t)}},{key:"integrate",value:function(t){if(this.parent){var e=1-this.damping;this.parent.integrator.calculate(this,t,e);for(var i=void 0,a=void 0,i=this.particles.length-1;0<=i;i--)(a=this.particles[i]).update(t,i),this.parent.integrator.calculate(a,t,e),this.dispatch("PARTICLE_UPDATE",a),a.dead&&(this.dispatch("PARTICLE_DEAD",a),this.parent.pool.expire(a),this.particles.splice(i,1))}}},{key:"dispatch",value:function(t,e){this.parent&&this.parent.dispatchEvent(t,e),this.bindEvent&&this.dispatchEvent(t,e)}},{key:"emitting",value:function(t){if("once"===this.totalTime){var e=void 0,i=this.rate.getValue(99999);for(0<i&&(this.emitSpeed=i),e=0;e<i;e++)this.createParticle();this.totalTime="none"}else if(this.emitTime+=t,this.emitTime<this.totalTime){var a=this.rate.getValue(t),n=void 0;for(0<a&&(this.emitSpeed=a),n=0;n<a;n++)this.createParticle()}}},{key:"createParticle",value:function(t,e){var i=this.parent.pool.get(U);return this.setupParticle(i,t,e),this.dispatch("PARTICLE_CREATED",i),i}},{key:"setupParticle",value:function(t,e,i){var a=this.initializes,n=this.behaviours;e&&(a=_.toArray(e)),i&&(n=_.toArray(i)),t.reset(),tN.initialize(this,t,a),t.addBehaviours(n),(t.parent=this).particles.push(t)}},{key:"remove",value:function(){this.stop(),_.destroyAll(this.particles)}},{key:"destroy",value:function(){this.dead=!0,this.remove(),this.removeAllInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this)}}]),tG);function tG(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return i(this,tG),(t=o(this,(tG.__proto__||Object.getPrototypeOf(tG)).call(this,t))).particles=[],t.behaviours=[],t.initializes=[],t.emitTime=0,t.emitSpeed=0,t.totalTime=-1,t.damping=.006,t.bindEmitter=!0,t.rate=new W(1,.1),t.name="Emitter",t.id=x.id(t.name),t}w.bind(tq);var tX=(s(tY,tq),a(tY,[{key:"addSelfBehaviour",value:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var a=void 0,n=e.length,a=0;a<n;a++){var r=e[a];this.selfBehaviours.push(r),r.initialize(this)}}},{key:"removeSelfBehaviour",value:function(t){-1<(t=this.selfBehaviours.indexOf(t))&&this.selfBehaviours.splice(t,1)}},{key:"update",value:function(t){if(r(tY.prototype.__proto__||Object.getPrototypeOf(tY.prototype),"update",this).call(this,t),!this.sleep)for(var e=this.selfBehaviours.length,i=void 0,i=0;i<e;i++)this.selfBehaviours[i].applyBehaviour(this,t,i)}}]),tY);function tY(t){return i(this,tY),(t=o(this,(tY.__proto__||Object.getPrototypeOf(tY)).call(this,t))).selfBehaviours=[],t}var tW=(s(tZ,tq),a(tZ,[{key:"initEventHandler",value:function(){var t=this;this.mousemoveHandler=function(e){return t.mousemove.call(t,e)},this.mousedownHandler=function(e){return t.mousedown.call(t,e)},this.mouseupHandler=function(e){return t.mouseup.call(t,e)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)}},{key:"emit",value:function(){this._allowEmitting=!0}},{key:"stop",value:function(){this._allowEmitting=!1}},{key:"mousemove",value:function(t){t.layerX||0===t.layerX?(this.p.x+=(t.layerX-this.p.x)*this.ease,this.p.y+=(t.layerY-this.p.y)*this.ease):(t.offsetX||0===t.offsetX)&&(this.p.x+=(t.offsetX-this.p.x)*this.ease,this.p.y+=(t.offsetY-this.p.y)*this.ease),this._allowEmitting&&r(tZ.prototype.__proto__||Object.getPrototypeOf(tZ.prototype),"emit",this).call(this,"once")}},{key:"destroy",value:function(){r(tZ.prototype.__proto__||Object.getPrototypeOf(tZ.prototype),"destroy",this).call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)}}]),tZ);function tZ(t,e,a){return i(this,tZ),(a=o(this,(tZ.__proto__||Object.getPrototypeOf(tZ)).call(this,a))).mouseTarget=_.initValue(t,window),a.ease=_.initValue(e,.7),a._allowEmitting=!1,a.initEventHandler(),a}var tQ=(a(tK,[{key:"setStroke",value:function(t,e){t=0<arguments.length&&void 0!==t?t:"#000000",e=1<arguments.length&&void 0!==e?e:1,this.stroke={color:t,thinkness:e}}},{key:"initHandler",value:function(){var t=this;this._protonUpdateHandler=function(){t.onProtonUpdate.call(t)},this._protonUpdateAfterHandler=function(){t.onProtonUpdateAfter.call(t)},this._emitterAddedHandler=function(e){t.onEmitterAdded.call(t,e)},this._emitterRemovedHandler=function(e){t.onEmitterRemoved.call(t,e)},this._particleCreatedHandler=function(e){t.onParticleCreated.call(t,e)},this._particleUpdateHandler=function(e){t.onParticleUpdate.call(t,e)},this._particleDeadHandler=function(e){t.onParticleDead.call(t,e)}}},{key:"init",value:function(t){(this.parent=t).addEventListener("PROTON_UPDATE",this._protonUpdateHandler),t.addEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),t.addEventListener("EMITTER_ADDED",this._emitterAddedHandler),t.addEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),t.addEventListener("PARTICLE_CREATED",this._particleCreatedHandler),t.addEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),t.addEventListener("PARTICLE_DEAD",this._particleDeadHandler)}},{key:"resize",value:function(){}},{key:"destroy",value:function(){this.remove()}},{key:"remove",value:function(){this.parent.removeEventListener("PROTON_UPDATE",this._protonUpdateHandler),this.parent.removeEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),this.parent.removeEventListener("EMITTER_ADDED",this._emitterAddedHandler),this.parent.removeEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),this.parent.removeEventListener("PARTICLE_CREATED",this._particleCreatedHandler),this.parent.removeEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),this.parent.removeEventListener("PARTICLE_DEAD",this._particleDeadHandler),this.parent=null}},{key:"onProtonUpdate",value:function(){}},{key:"onProtonUpdateAfter",value:function(){}},{key:"onEmitterAdded",value:function(){}},{key:"onEmitterRemoved",value:function(){}},{key:"onParticleCreated",value:function(){}},{key:"onParticleUpdate",value:function(){}},{key:"onParticleDead",value:function(){}}]),tK);function tK(t,e){i(this,tK),this.pool=new E,this.element=t,this.stroke=e,this.circleConf={isCircle:!0},this.initHandler(),this.name="BaseRenderer"}var tJ=(s(t$,tQ),a(t$,[{key:"resize",value:function(t,e){this.element.width=t,this.element.height=e}},{key:"onProtonUpdate",value:function(){this.context.clearRect(0,0,this.element.width,this.element.height)}},{key:"onParticleCreated",value:function(t){t.body?m(t.body,this.addImg2Body,t):t.color=t.color||"#ff0000"}},{key:"onParticleUpdate",value:function(t){t.body?t.body instanceof Image&&this.drawImage(t):this.drawCircle(t)}},{key:"onParticleDead",value:function(t){t.body=null}},{key:"addImg2Body",value:function(t,e){e.body=t}},{key:"drawImage",value:function(e){var i,a=e.body.width*e.scale|0,n=e.body.height*e.scale|0,r=e.p.x-a/2,s=e.p.y-n/2;e.color?(e.data.buffer||(e.data.buffer=this.createBuffer(e.body)),(i=e.data.buffer.getContext("2d")).clearRect(0,0,e.data.buffer.width,e.data.buffer.height),i.globalAlpha=e.alpha,i.drawImage(e.body,0,0),i.globalCompositeOperation="source-atop",i.fillStyle=z.rgbToHex(e.rgb),i.fillRect(0,0,e.data.buffer.width,e.data.buffer.height),i.globalCompositeOperation="source-over",i.globalAlpha=1,this.context.drawImage(e.data.buffer,0,0,e.data.buffer.width,e.data.buffer.height,r,s,a,n)):(this.context.save(),this.context.globalAlpha=e.alpha,this.context.translate(e.p.x,e.p.y),this.context.rotate(t.degreeTransform(e.rotation)),this.context.translate(-e.p.x,-e.p.y),this.context.drawImage(e.body,0,0,e.body.width,e.body.height,r,s,a,n),this.context.globalAlpha=1,this.context.restore())}},{key:"drawCircle",value:function(t){t.rgb?this.context.fillStyle="rgba("+t.rgb.r+","+t.rgb.g+","+t.rgb.b+","+t.alpha+")":this.context.fillStyle=t.color,this.context.beginPath(),this.context.arc(t.p.x,t.p.y,t.radius,0,2*Math.PI,!0),this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke()),this.context.closePath(),this.context.fill()}},{key:"createBuffer",value:function(t){if(t instanceof Image){var e=t.width+"_"+t.height,i=this.bufferCache[e];return i||((i=document.createElement("canvas")).width=t.width,i.height=t.height,this.bufferCache[e]=i),i}}}]),t$);function t$(t){return i(this,t$),(t=o(this,(t$.__proto__||Object.getPrototypeOf(t$)).call(this,t))).stroke=null,t.context=t.element.getContext("2d"),t.bufferCache={},t.name="CanvasRenderer",t}var t0=(s(t1,tQ),a(t1,[{key:"onParticleCreated",value:function(t){t.body?m(t.body,this.addImg2Body,t):(t.body=this.pool.get(this.circleConf,t),this.element.appendChild(t.body))}},{key:"onParticleUpdate",value:function(t){this.bodyReady(t)&&(this.transform3d?y.transform3d(t.body,t.p.x,t.p.y,t.scale,t.rotation):y.transform(t.body,t.p.x,t.p.y,t.scale,t.rotation),t.body.style.opacity=t.alpha,t.body.isCircle&&(t.body.style.backgroundColor=t.color||"#ff0000"))}},{key:"onParticleDead",value:function(t){this.bodyReady(t)&&(this.element.removeChild(t.body),this.pool.expire(t.body),t.body=null)}},{key:"bodyReady",value:function(t){return"object"===e(t.body)&&t.body&&!t.body.isInner}},{key:"addImg2Body",value:function(t,e){e.dead||(e.body=this.pool.get(t,e),y.resize(e.body,t.width,t.height),this.element.appendChild(e.body))}},{key:"createBody",value:function(t,e){return t.isCircle?this.createCircle(e):this.createSprite(t,e)}},{key:"createCircle",value:function(t){var e=y.createDiv(t.id+"_dom",2*t.radius,2*t.radius);return e.style.borderRadius=t.radius+"px",this.stroke&&(e.style.borderColor=this.stroke.color,e.style.borderWidth=this.stroke.thinkness+"px"),e.isCircle=!0,e}},{key:"createSprite",value:function(t,e){var i="string"==typeof t?t:t.src,t=y.createDiv(e.id+"_dom",t.width,t.height);return t.style.backgroundImage="url("+i+")",t}}]),t1);function t1(t){i(this,t1);var e=o(this,(t1.__proto__||Object.getPrototypeOf(t1)).call(this,t));return e.stroke=null,e.pool.create=function(t,i){return e.createBody(t,i)},e.addImg2Body=e.addImg2Body.bind(e),e.transform3d=!1,e.name="DomRenderer",e}var t2=(s(t5,tQ),a(t5,[{key:"onParticleCreated",value:function(t){t.body?this.createSprite(t):this.createCircle(t),this.element.addChild(t.body)}},{key:"onParticleUpdate",value:function(t){t.body&&(t.body.x=t.p.x,t.body.y=t.p.y,t.body.alpha=t.alpha,t.body.scaleX=t.body.scaleY=t.scale,t.body.rotation=t.rotation)}},{key:"onParticleDead",value:function(t){t.body&&(t.body.parent&&t.body.parent.removeChild(t.body),this.pool.expire(t.body),t.body=null),t.graphics&&this.pool.expire(t.graphics)}},{key:"createSprite",value:function(t){t.body=this.pool.get(t.body),t.body.parent||t.body.image&&(t.body.regX=t.body.image.width/2,t.body.regY=t.body.image.height/2)}},{key:"createCircle",value:function(t){var e=this.pool.get(createjs.Graphics);this.stroke&&(this.stroke instanceof String?e.beginStroke(this.stroke):e.beginStroke("#000000")),e.beginFill(t.color||"#ff0000").drawCircle(0,0,t.radius);var i=this.pool.get(createjs.Shape,[e]);t.body=i,t.graphics=e}}]),t5);function t5(t,e){return i(this,t5),(t=o(this,(t5.__proto__||Object.getPrototypeOf(t5)).call(this,t))).stroke=e,t.name="EaselRenderer",t}var t3=(s(t6,tQ),a(t6,[{key:"resize",value:function(t,e){this.element.width=t,this.element.height=e}},{key:"createImageData",value:function(t){this.rectangle=t||new X(0,0,this.element.width,this.element.height),this.imageData=this.context.createImageData(this.rectangle.width,this.rectangle.height),this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)}},{key:"onProtonUpdate",value:function(){this.context.clearRect(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),this.imageData=this.context.getImageData(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)}},{key:"onProtonUpdateAfter",value:function(){this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)}},{key:"onParticleCreated",value:function(){}},{key:"onParticleUpdate",value:function(t){this.imageData&&this.setPixel(this.imageData,Math.floor(t.p.x-this.rectangle.x),Math.floor(t.p.y-this.rectangle.y),t)}},{key:"setPixel",value:function(t,e,i,a){var n=a.rgb;e<0||e>this.element.width||i<0||i>this.elementwidth||(e=4*((i>>0)*t.width+(e>>0)),t.data[e]=n.r,t.data[1+e]=n.g,t.data[2+e]=n.b,t.data[3+e]=255*a.alpha)}},{key:"onParticleDead",value:function(){}}]),t6);function t6(t,e){return i(this,t6),(t=o(this,(t6.__proto__||Object.getPrototypeOf(t6)).call(this,t))).context=t.element.getContext("2d"),t.imageData=null,t.rectangle=null,t.rectangle=e,t.createImageData(e),t.name="PixelRenderer",t}var t4=void 0,t7=(s(t9,tQ),a(t9,[{key:"setPIXI",value:function(t){try{t4=t||{Sprite:{}},this.createFromImage=t4.Sprite.from||t4.Sprite.fromImage}catch(t){}}},{key:"onProtonUpdate",value:function(){}},{key:"onParticleCreated",value:function(t){t.body?t.body=this.pool.get(t.body,t):t.body=this.pool.get(this.circleConf,t),this.blendMode&&(t.body.blendMode=this.blendMode),this.element.addChild(t.body)}},{key:"onParticleUpdate",value:function(t){this.transform(t,t.body),!0!==this.setColor&&!0!==this.color||(t.body.tint=z.getHex16FromParticle(t))}},{key:"onParticleDead",value:function(t){this.element.removeChild(t.body),this.pool.expire(t.body),t.body=null}},{key:"destroy",value:function(t){r(t9.prototype.__proto__||Object.getPrototypeOf(t9.prototype),"destroy",this).call(this),this.pool.destroy();for(var e=t.length;e--;){var i=t[e];i.body&&this.element.removeChild(i.body)}}},{key:"transform",value:function(e,i){i.x=e.p.x,i.y=e.p.y,i.alpha=e.alpha,i.scale.x=e.scale,i.scale.y=e.scale,i.rotation=e.rotation*t.PI_180}},{key:"createBody",value:function(t,e){return t.isCircle?this.createCircle(e):this.createSprite(t)}},{key:"createSprite",value:function(t){return(t=t.isInner?this.createFromImage(t.src):new t4.Sprite(t)).anchor.x=.5,t.anchor.y=.5,t}},{key:"createCircle",value:function(t){var e,i=new t4.Graphics;return this.stroke&&(e=this.stroke instanceof String?this.stroke:0,i.beginStroke(e)),i.beginFill(t.color||36077),i.drawCircle(0,0,t.radius),i.endFill(),i}}]),t9);function t9(t,e){i(this,t9);var a=o(this,(t9.__proto__||Object.getPrototypeOf(t9)).call(this,t));return a.stroke=e,a.color=!1,a.setColor=!1,a.blendMode=null,a.pool.create=function(t,e){return a.createBody(t,e)},a.setPIXI(window.PIXI),a.name="PixiRenderer",a}var t8=(a(et,[{key:"set",value:function(t,e){0===e?N.set(t,this.mats[0]):N.multiply(this.mats[e-1],t,this.mats[e]),this.size=Math.max(this.size,e+1)}},{key:"push",value:function(t){0===this.size?N.set(t,this.mats[0]):N.multiply(this.mats[this.size-1],t,this.mats[this.size]),this.size++}},{key:"pop",value:function(){0<this.size&&this.size--}},{key:"top",value:function(){return this.mats[this.size-1]}}]),et);function et(){i(this,et),this.mats=[];for(var t=this.size=0;t<20;t++)this.mats.push(N.create([0,0,0,0,0,0,0,0,0]))}function ee(t){return i(this,ee),(t=o(this,(ee.__proto__||Object.getPrototypeOf(ee)).call(this,t))).gl=t.element.getContext("experimental-webgl",{antialias:!0,stencil:!1,depth:!1}),t.gl||alert("Sorry your browser do not suppest WebGL!"),t.initVar(),t.setMaxRadius(),t.initShaders(),t.initBuffers(),t.gl.blendEquation(t.gl.FUNC_ADD),t.gl.blendFunc(t.gl.SRC_ALPHA,t.gl.ONE_MINUS_SRC_ALPHA),t.gl.enable(t.gl.BLEND),t.addImg2Body=t.addImg2Body.bind(t),t.name="WebGLRenderer",t}function ei(t){return i(this,ei),(t=o(this,(ei.__proto__||Object.getPrototypeOf(ei)).call(this,t))).name="CustomRenderer",t}s(ee,tQ),a(ee,[{key:"init",value:function(t){r(ee.prototype.__proto__||Object.getPrototypeOf(ee.prototype),"init",this).call(this,t),this.resize(this.element.width,this.element.height)}},{key:"resize",value:function(t,e){this.umat[4]=-2,this.umat[7]=1,this.smat[0]=1/t,this.smat[4]=1/e,this.mstack.set(this.umat,0),this.mstack.set(this.smat,1),this.gl.viewport(0,0,t,e),this.element.width=t,this.element.height=e}},{key:"setMaxRadius",value:function(t){this.circleCanvasURL=this.createCircle(t)}},{key:"getVertexShader",value:function(){return"uniform vec2 viewport;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 tMat;\nvarying vec2 vTextureCoord;\nvarying float alpha;\nvoid main() {\nvec3 v = tMat * vec3(aVertexPosition, 1.0);\ngl_Position = vec4(v.x, v.y, 0, 1);\nvTextureCoord = aTextureCoord;\nalpha = tMat[0][2];\n}"}},{key:"getFragmentShader",value:function(){return"precision mediump float;\nvarying vec2 vTextureCoord;\nvarying float alpha;\nuniform sampler2D uSampler;\nuniform vec4 color;\nuniform bool useTexture;\nuniform vec3 uColor;\nvoid main() {\nvec4 textureColor = texture2D(uSampler, vTextureCoord);\ngl_FragColor = textureColor * vec4(uColor, 1.0);\ngl_FragColor.w *= alpha;\n}"}},{key:"initVar",value:function(){this.mstack=new t8,this.umat=N.create([2,0,1,0,-2,0,-1,1,1]),this.smat=N.create([.01,0,1,0,.01,0,0,0,1]),this.texturebuffers={}}},{key:"blendEquation",value:function(t){this.gl.blendEquation(this.gl[t])}},{key:"blendFunc",value:function(t,e){this.gl.blendFunc(this.gl[t],this.gl[e])}},{key:"getShader",value:function(t,e,i){return i=i?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER),t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(alert(t.getShaderInfoLog(i)),null)}},{key:"initShaders",value:function(){var t=this.getShader(this.gl,this.getFragmentShader(),!0),e=this.getShader(this.gl,this.getVertexShader(),!1);this.sprogram=this.gl.createProgram(),this.gl.attachShader(this.sprogram,e),this.gl.attachShader(this.sprogram,t),this.gl.linkProgram(this.sprogram),this.gl.getProgramParameter(this.sprogram,this.gl.LINK_STATUS)||alert("Could not initialise shaders"),this.gl.useProgram(this.sprogram),this.sprogram.vpa=this.gl.getAttribLocation(this.sprogram,"aVertexPosition"),this.sprogram.tca=this.gl.getAttribLocation(this.sprogram,"aTextureCoord"),this.gl.enableVertexAttribArray(this.sprogram.tca),this.gl.enableVertexAttribArray(this.sprogram.vpa),this.sprogram.tMatUniform=this.gl.getUniformLocation(this.sprogram,"tMat"),this.sprogram.samplerUniform=this.gl.getUniformLocation(this.sprogram,"uSampler"),this.sprogram.useTex=this.gl.getUniformLocation(this.sprogram,"useTexture"),this.sprogram.color=this.gl.getUniformLocation(this.sprogram,"uColor"),this.gl.uniform1i(this.sprogram.useTex,1)}},{key:"initBuffers",value:function(){var t;this.unitIBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,3,1,0,2,3]),this.gl.STATIC_DRAW);for(var e=void 0,i=[],e=0;e<100;e++)i.push(e);for(t=new Uint16Array(i),this.unitI33=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitI33),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW),i=[],e=0;e<100;e++)i.push(e,e+1,e+2);t=new Uint16Array(i),this.stripBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.stripBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW)}},{key:"createCircle",value:function(t){this.circleCanvasRadius=u(_.initValue(t,32));var e=y.createCanvas("circle_canvas",2*this.circleCanvasRadius,2*this.circleCanvasRadius),t=e.getContext("2d");return t.beginPath(),t.arc(this.circleCanvasRadius,this.circleCanvasRadius,this.circleCanvasRadius,0,2*Math.PI,!0),t.closePath(),t.fillStyle="#FFF",t.fill(),e.toDataURL()}},{key:"drawImg2Canvas",value:function(t){var e=t.body.width,i=t.body.height,a=u(t.body.width),n=u(t.body.height),r=t.body.width/a,s=t.body.height/n;this.texturebuffers[t.data.src]||(this.texturebuffers[t.data.src]=[this.gl.createTexture(),this.gl.createBuffer(),this.gl.createBuffer()]),t.data.texture=this.texturebuffers[t.data.src][0],t.data.vcBuffer=this.texturebuffers[t.data.src][1],t.data.tcBuffer=this.texturebuffers[t.data.src][2],this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.tcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,r,0,0,s,s,s]),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.vcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,e,0,0,i,e,i]),this.gl.STATIC_DRAW),n=t.data.canvas.getContext("2d").getImageData(0,0,a,n),this.gl.bindTexture(this.gl.TEXTURE_2D,t.data.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST),this.gl.generateMipmap(this.gl.TEXTURE_2D),t.data.textureLoaded=!0,t.data.textureWidth=e,t.data.textureHeight=i}},{key:"onProtonUpdate",value:function(){}},{key:"onParticleCreated",value:function(t){t.data.textureLoaded=!1,t.data.tmat=N.create(),t.data.tmat[8]=1,t.data.imat=N.create(),t.data.imat[8]=1,t.body?m(t.body,this.addImg2Body,t):(m(this.circleCanvasURL,this.addImg2Body,t),t.data.oldScale=t.radius/this.circleCanvasRadius)}},{key:"addImg2Body",value:function(t,e){e.dead||(e.body=t,e.data.src=t.src,e.data.canvas=b(t),e.data.oldScale=1,this.drawImg2Canvas(e))}},{key:"onParticleUpdate",value:function(t){t.data.textureLoaded&&(this.updateMatrix(t),this.gl.uniform3f(this.sprogram.color,t.rgb.r/255,t.rgb.g/255,t.rgb.b/255),this.gl.uniformMatrix3fv(this.sprogram.tMatUniform,!1,this.mstack.top()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.vcBuffer),this.gl.vertexAttribPointer(this.sprogram.vpa,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.tcBuffer),this.gl.vertexAttribPointer(this.sprogram.tca,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,t.data.texture),this.gl.uniform1i(this.sprogram.samplerUniform,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0),this.mstack.pop())}},{key:"onParticleDead",value:function(){}},{key:"updateMatrix",value:function(e){var i=c(-e.data.textureWidth/2,-e.data.textureHeight/2),a=c(e.p.x,e.p.y),n=e.rotation*t.PI_180,r=d(n),n=e.scale*e.data.oldScale,n=[n,0,0,0,n,0,0,0,1],n=p(i,n),n=p(n,r);n=p(n,a),N.inverse(n,e.data.imat),n[2]=e.alpha,this.mstack.push(n)}}]),w=ee,s(ei,tQ),tQ=ei;var ea=(s(en,tt),a(en,[{key:"getPosition",value:function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient),this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient),this.vector}},{key:"getDirection",value:function(t,e){var i=this.dy,a=-this.dx;return 0<(i*t+a*e+this.dot)*(0==a?1:a)}},{key:"getDistance",value:function(t,e){return(this.dy*t+-this.dx*e+this.dot)/Math.sqrt(this.xxyy)}},{key:"getSymmetric",value:function(t){var e=t.getGradient(),i=2*(this.getGradient()-e),a=t.x,e=t.y;return t.x=a*Math.cos(i)-e*Math.sin(i),t.y=a*Math.sin(i)+e*Math.cos(i),t}},{key:"getGradient",value:function(){return Math.atan2(this.dy,this.dx)}},{key:"rangeOut",value:function(e){if(Math.abs(this.getGradient())<=t.PI/4){if(e.p.x<=this.maxx&&e.p.x>=this.minx)return!0}else if(e.p.y<=this.maxy&&e.p.y>=this.miny)return!0;return!1}},{key:"getLength",value:function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)}},{key:"crossing",value:function(t){"dead"===this.crossType?">"===this.direction||"R"===this.direction||"right"===this.direction||"down"===this.direction?this.rangeOut(t)&&this.getDirection(t.p.x,t.p.y)&&(t.dead=!0):this.rangeOut(t)&&(this.getDirection(t.p.x,t.p.y)||(t.dead=!0)):"bound"===this.crossType?this.rangeOut(t)&&this.getDistance(t.p.x,t.p.y)<=t.radius&&(0===this.dx?t.v.x*=-1:0===this.dy?t.v.y*=-1:this.getSymmetric(t.v)):"cross"===this.crossType&&this.alert&&(console.error("Sorry, LineZone does not support cross method!"),this.alert=!1)}}]),en);function en(t,e,a,n,r){i(this,en);var s=o(this,(en.__proto__||Object.getPrototypeOf(en)).call(this));return 0<=a-t?(s.x1=t,s.y1=e,s.x2=a,s.y2=n):(s.x1=a,s.y1=n,s.x2=t,s.y2=e),s.dx=s.x2-s.x1,s.dy=s.y2-s.y1,s.minx=Math.min(s.x1,s.x2),s.miny=Math.min(s.y1,s.y2),s.maxx=Math.max(s.x1,s.x2),s.maxy=Math.max(s.y1,s.y2),s.dot=s.x2*s.y1-s.x1*s.y2,s.xxyy=s.dx*s.dx+s.dy*s.dy,s.gradient=s.getGradient(),s.length=s.getLength(),s.direction=_.initValue(r,">"),s}var er=(s(es,tt),a(es,[{key:"getPosition",value:function(){return this.angle=t.PIx2*Math.random(),this.randomRadius=Math.random()*this.radius,this.vector.x=this.x+this.randomRadius*Math.cos(this.angle),this.vector.y=this.y+this.randomRadius*Math.sin(this.angle),this.vector}},{key:"setCenter",value:function(t,e){this.center.x=t,this.center.y=e}},{key:"crossing",value:function(t){var e=t.p.distanceTo(this.center);"dead"===this.crossType?e-t.radius>this.radius&&(t.dead=!0):"bound"===this.crossType?e+t.radius>=this.radius&&this.getSymmetric(t):"cross"===this.crossType&&this.alert&&(console.error("Sorry, CircleZone does not support cross method!"),this.alert=!1)}},{key:"getSymmetric",value:function(t){var e=t.v.getGradient(),i=2*(this.getGradient(t)-e),a=t.v.x,e=t.v.y;t.v.x=a*Math.cos(i)-e*Math.sin(i),t.v.y=a*Math.sin(i)+e*Math.cos(i)}},{key:"getGradient",value:function(e){return-t.PI_2+Math.atan2(e.p.y-this.center.y,e.p.x-this.center.x)}}]),es);function es(t,e,a){i(this,es);var n=o(this,(es.__proto__||Object.getPrototypeOf(es)).call(this));return n.x=t,n.y=e,n.radius=a,n.angle=0,n.center={x:t,y:e},n}var eo=(s(eh,tt),a(eh,[{key:"getPosition",value:function(){return this.vector.x=this.x+Math.random()*this.width,this.vector.y=this.y+Math.random()*this.height,this.vector}},{key:"crossing",value:function(t){"dead"===this.crossType?((t.p.x+t.radius<this.x||t.p.x-t.radius>this.x+this.width)&&(t.dead=!0),(t.p.y+t.radius<this.y||t.p.y-t.radius>this.y+this.height)&&(t.dead=!0)):"bound"===this.crossType?(t.p.x-t.radius<this.x?(t.p.x=this.x+t.radius,t.v.x*=-1):t.p.x+t.radius>this.x+this.width&&(t.p.x=this.x+this.width-t.radius,t.v.x*=-1),t.p.y-t.radius<this.y?(t.p.y=this.y+t.radius,t.v.y*=-1):t.p.y+t.radius>this.y+this.height&&(t.p.y=this.y+this.height-t.radius,t.v.y*=-1)):"cross"===this.crossType&&(t.p.x+t.radius<this.x&&t.v.x<=0?t.p.x=this.x+this.width+t.radius:t.p.x-t.radius>this.x+this.width&&0<=t.v.x&&(t.p.x=this.x-t.radius),t.p.y+t.radius<this.y&&t.v.y<=0?t.p.y=this.y+this.height+t.radius:t.p.y-t.radius>this.y+this.height&&0<=t.v.y&&(t.p.y=this.y-t.radius))}}]),eh);function eh(t,e,a,n){i(this,eh);var r=o(this,(eh.__proto__||Object.getPrototypeOf(eh)).call(this));return r.x=t,r.y=e,r.width=a,r.height=n,r}function el(t,e,a,n){i(this,el);var r=o(this,(el.__proto__||Object.getPrototypeOf(el)).call(this));return r.reset(t,e,a,n),r}return s(el,tt),a(el,[{key:"reset",value:function(t,e,i,a){this.imageData=t,this.x=_.initValue(e,0),this.y=_.initValue(i,0),this.d=_.initValue(a,2),this.vectors=[],this.setVectors()}},{key:"setVectors",value:function(){for(var t=void 0,e=void 0,i=this.imageData.width,a=this.imageData.height,t=0;t<i;t+=this.d)for(e=0;e<a;e+=this.d){var n=4*((e>>0)*i+(t>>0));0<this.imageData.data[3+n]&&this.vectors.push({x:t+this.x,y:e+this.y})}return this.vector}},{key:"getBound",value:function(t,e){return t=4*((e>>0)*this.imageData.width+(t>>0)),0<this.imageData.data[3+t]}},{key:"getPosition",value:function(){var t=_.getRandFromArray(this.vectors);return this.vector.copy(t)}},{key:"getColor",value:function(t,e){return t-=this.x,t=4*(((e-=this.y)>>0)*this.imageData.width+(t>>0)),{r:this.imageData.data[t],g:this.imageData.data[1+t],b:this.imageData.data[2+t],a:this.imageData.data[3+t]}}},{key:"crossing",value:function(t){"dead"===this.crossType?this.getBound(t.p.x-this.x,t.p.y-this.y)?t.dead=!0:t.dead=!1:"bound"===this.crossType&&(this.getBound(t.p.x-this.x,t.p.y-this.y)||t.v.negate())}}]),s=el,a={addEventListener:function(t,e){t.addEventListener("PROTON_UPDATE_AFTER",function(){return e()})},getStyle:function(t){return t=z.hexToRgb(0<arguments.length&&void 0!==t?t:"#ff0000"),"rgba("+t.r+", "+t.g+", "+t.b+", 0.5)"},drawZone:function(t,e,i,a){var n=e.getContext("2d"),r=this.getStyle();this.addEventListener(t,function(){a&&n.clearRect(0,0,e.width,e.height),i instanceof ti?(n.beginPath(),n.fillStyle=r,n.arc(i.x,i.y,10,0,2*Math.PI,!0),n.fill(),n.closePath()):i instanceof ea?(n.beginPath(),n.strokeStyle=r,n.moveTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.stroke(),n.closePath()):i instanceof eo?(n.beginPath(),n.strokeStyle=r,n.drawRect(i.x,i.y,i.width,i.height),n.stroke(),n.closePath()):i instanceof er&&(n.beginPath(),n.strokeStyle=r,n.arc(i.x,i.y,i.radius,0,2*Math.PI,!0),n.stroke(),n.closePath())})},drawEmitter:function(t,e,i,a){var n=e.getContext("2d"),r=this.getStyle();this.addEventListener(t,function(){a&&n.clearRect(0,0,e.width,e.height),n.beginPath(),n.fillStyle=r,n.arc(i.p.x,i.p.y,10,0,2*Math.PI,!0),n.fill(),n.closePath()})}},I.Particle=U,I.Pool=E,I.Util=_,I.ColorUtil=z,I.MathUtil=t,I.Vector2D=I.Vector=B,I.Polar2D=I.Polar=j,I.ArraySpan=q,I.Rectangle=X,I.Rate=W,I.ease=V,I.Span=h,I.Mat3=N,I.getSpan=function(t,e,i){return new h(t,e,i)},I.createArraySpan=q.createArraySpan,I.Initialize=I.Init=Q,I.Life=I.L=J,I.Position=I.P=tn,I.Velocity=I.V=ts,I.Mass=I.M=th,I.Radius=I.R=tu,I.Body=I.B=td,I.Behaviour=ty,I.Force=I.F=tv,I.Attraction=I.A=tm,I.RandomDrift=I.RD=t_,I.Gravity=I.G=tx,I.Collision=tP,I.CrossZone=tT,I.Alpha=tR,I.Scale=I.S=tC,I.Rotate=tS,I.Color=tM,I.Repulsion=tF,I.Cyclone=tL,I.GravityWell=tj,I.Emitter=tq,I.BehaviourEmitter=tX,I.FollowEmitter=tW,I.Zone=tt,I.LineZone=ea,I.CircleZone=er,I.PointZone=ti,I.RectZone=eo,I.ImageZone=s,I.CanvasRenderer=tJ,I.DomRenderer=t0,I.EaselRenderer=t2,I.PixiRenderer=t7,I.PixelRenderer=t3,I.WebGLRenderer=I.WebGlRenderer=w,I.CustomRenderer=tQ,I.Debug=a,_.assign(I,V),I}()},8334:function(t){/*!
* RAFManager v0.1.0
*
* Copyright 2018-2018, ajiemath <ajiemath@gmail.com>
* Licensed under the MIT license
* http://www.opensource.org/licenses/mit-license
*
*/t.exports=(function(){for(var t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"]}(),{timer:0,state:"stop",animations:[],add:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,i={callback:t,fps:e,n:60/e,param:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i:0};return this.animations.push(i),this.animations.length>=1&&this.start(),this},getIndex:function(t){for(var e=0;e<this.animations.length;e++)if(this.animations[e].callback===t)return e;return -1},remove:function(t){if(!(0>this.getIndex(t)))return this.deleteMap(t),0===this.animations.length&&this.stop(),this},deleteMap:function(t){var e=this.getIndex(t),i=this.animations[e];for(var a in i)delete i[a];this.animations.splice(e,1)},start:function(){if("start"!==this.state)return this.state="start",this.tick(),this},stop:function(){if("stop"!==this.state)return this.state="stop",cancelAnimationFrame(this.timer),this},tick:function(){var t=this;this.timer=requestAnimationFrame(function(){t.tick()});for(var e=0;e<this.animations.length;e++){var i=this.animations[e],a=i.callback,n=i.param;i.i++,i.i>=i.n&&(a(n),i.i=0)}}})},6644:function(t,e,i){"use strict";i.r(e);var a=i(7294),n=i(2075),r=i.n(n),s=i(8334),o=i.n(s),h=function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")},l=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),u=function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},c=function(t,e){if(!t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&("object"==typeof e||"function"==typeof e)?e:t},d=function(t){function e(t){h(this,e);var i=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.ease=.7,i.level=0,i.LEVEL=5,i._allowEmitting=!0,i.renderProton=i.renderProton.bind(i),i.mouseMoveHandler=i.mouseMoveHandler.bind(i),i.mouseDownHandler=i.mouseDownHandler.bind(i),i.mouseUpHandler=i.mouseUpHandler.bind(i),i.createContainerDom(),i}return u(e,t),l(e,[{key:"createContainerDom",value:function(){this.dom=document.createElement("div"),this.dom.style.position="fixed",this.dom.style.left="0px",this.dom.style.top="0px",this.dom.style.zIndex=9999,this.dom.style.pointerEvents="none",this.dom.id="mouse_ps_"+(999999*Math.random()>>0),document.body.appendChild(this.dom)}},{key:"componentWillUnmount",value:function(){try{document.body.removeEventListener("mousemove",this.mouseMoveHandler,!1),document.body.removeEventListener("mousedown",this.mouseDownHandler,!1),document.body.removeEventListener("mouseup",this.mouseUpHandler,!1),o().remove(this.renderProton),this.proton.destroy()}catch(t){}}},{key:"componentDidMount",value:function(){this.onCanvasInited(),this.addMouseEventListener(),this.setCullList()}},{key:"onCanvasInited",value:function(){this.createProton(),o().add(this.renderProton)}},{key:"addMouseEventListener",value:function(){document.body.addEventListener("mousemove",this.mouseMoveHandler,!1),document.body.addEventListener("mousedown",this.mouseDownHandler,!1),document.body.addEventListener("mouseup",this.mouseUpHandler,!1)}},{key:"mouseDownHandler",value:function(t){}},{key:"mouseUpHandler",value:function(t){}},{key:"mouseMoveHandler",value:function(t){if(!this.isCullDom(t)){var e=void 0,i=0;e=t.clientX,i=t.clientY,this.emitter.p.x+=(e-this.emitter.p.x)*this.ease,this.emitter.p.y+=(i-this.emitter.p.y)*this.ease,this._allowEmitting&&this.emitter.emit("once")}}},{key:"setCullList",value:function(){this.cullClassList=this.props.cull||"",this.cullClassList=this.cullClassList.split(","),this.LEVEL=this.props.level||6}},{key:"isCullDom",value:function(t){var e,i;return this.level=0,!!((e=t.target)instanceof HTMLInputElement&&"text"===e.type||"textarea"===(i=t.target.tagName.toLowerCase())||"input"===i)||!!this.cullClassList&&!!this.cullClassList.length&&this.isContain(t.target,this.cullClassList)}},{key:"isContain",value:function(t,e){if(this.level>=this.LEVEL||!t||!t.classList||t===document.body)return!1;for(var i=0;i<e.length;i++)if(t.classList.contains(e[i]))return!0;return this.level++,this.isContain(t.parentNode,e)}},{key:"createProton",value:function(t){this.proton=new(r());var e=new(r()).Emitter;e.rate=new(r()).Rate(this.props.num||3),e.damping=.008;var i=this.props.life?new(r()).Life(this.props.life):new(r()).Life(.2,.5),a=this.props.color||"random",n=this.props.g,s=this.props.v||.65,o=this.props.alpha||r().getSpan(.25,.55),h=this.props.tha?new(r()).Span(this.props.tha[0],this.props.tha[1]):new(r()).Span(0,360),l=new(r()).Radius(2,5);if(this.props.radius){var u=this.props.radius;l=new(r()).Radius(.8*u,u)}e.addInitialize(new(r()).Mass(1)),e.addInitialize(l),e.addInitialize(i),e.addInitialize(new(r()).Velocity(new(r()).Span(s),h,"polar")),e.addBehaviour(new(r()).Alpha(o)),e.addBehaviour(new(r()).Color(a)),e.addBehaviour(new(r()).Scale(1,.1)),e.addBehaviour(new(r()).RandomDrift(10,10,.2)),n&&e.addBehaviour(new(r()).G(parseFloat(n))),this.proton.addEmitter(e);var c=new(r()).DomRenderer(this.dom);this.proton.addRenderer(c),this.emitter=e}},{key:"renderProton",value:function(){this.proton&&this.proton.update()}},{key:"render",value:function(){return a.createElement(a.Fragment,null)}}]),e}(a.Component);e.default=d}}]);